import{Fa as m}from"./chunk-AS5JIIPJ.js";import{N as f,U as o,V as p,g as r,l as h,p as g}from"./chunk-NCX4KHCN.js";import{n as i}from"./chunk-MF24F5AL.js";function P(l,t=!0,e=!1){return Object.keys(l).reduce((a,s)=>{let n=l[s];return n===void 0||!e&&n===null||!t&&n===""||(a[s]=n),a},{})}var u=class extends m{data$=new r([]);count$=new r(0);initialized=!1;loading=new r(!1);itemLoading=new r(!1);get actualDataLength(){return this.data$.value.filter(t=>!!t).length}allowLocalFilter=!1;filter=new r("");filteredData$;constructor(){super(),this.initializeFiltering()}connect(t){return this.filteredData$.pipe(p(this.destroy$))}disconnect(t){this.onDestroy(),this.data$.complete(),this.itemLoading.complete(),this.loading.complete()}initializeFiltering(){let t=this.filter.pipe(f(this.data$),o(()=>h({data:this.data$.value,filterValue:this.filter.value})));this.filteredData$=t.pipe(o(({data:e,filterValue:a})=>!a||!this.allowLocalFilter?h(e):h(e.filter(s=>s&&this.filterPredicate(s,a)))))}initialize(){return i(this,null,function*(){this.initialized=!0;try{this.loading.next(!0),yield this.initializeData()}finally{this.loading.next(!1)}})}reset(){this.data$.next([]),this.count$.next(0)}propToString(t,e){return e==null?"":e.toString()}filterPredicate(t,e){let a=Object.keys(t).reduce((n,c)=>{let d=t[c];return n+this.propToString(c,d)+"\u25EC"},"").toLowerCase(),s=e.trim().toLowerCase();return a.indexOf(s)!=-1}retrieveFinalData(t){return i(this,null,function*(){let e=yield this.retrieveDataItems(t);return yield this.transformDataItems(e)})}initializeData(){return i(this,null,function*(){let t=yield this.retrieveFinalData();return this.data$.next(t.results),this.count$.next(t.count||t.results.length),t})}transformDataItems(t){return i(this,null,function*(){return t})}refresh(){return i(this,null,function*(){this.loading.next(!0);let t=yield this.initializeData();return this.loading.next(!1),t})}localUpdateDataItem(t,e){return t=P(t,!1,!0),Object.keys(t).length===0||this.data$.value.forEach(a=>{if(e(a))for(let s of Object.keys(t))a[s]=t[s]}),t}},D=class extends u{httpClient;params={};constructor(t){super(),this.httpClient=t}getParams(t){return t}getCount(t){let e=t.headers.get("X-Total-Count");return e==="null"?null:parseInt(e||"0",10)}getResults(t){return t.body}retrieveDataItems(t=null){return i(this,null,function*(){let e=yield g(this.httpClient.get(this.relativePath,{params:this.getParams(t||this.params),observe:"response"}));return{count:this.getCount(e),results:this.getResults(e)}})}},I=1e3,v=25;export{u as a,D as b,I as c,v as d};
//# sourceMappingURL=chunk-J72L73H6.js.map
